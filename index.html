<!DOCTYPE html>
<html lang="en">
<head>

  <meta charset="UTF-8">
  <title>Encriptador</title>
  
</head>
<body>
  <!--img id="imagen" src="pc.jpg" width="1024" height="647" alt=""-->
  <canvas id="lienzo" width="1024" height="647" style="border: 1px solid red;">
    El navegador no soporta canvas!
  </canvas>
  <canvas id="zoom" width="300" height="227"></canvas>
  

  <!--script start-->

  <script>
    
    let canvas = document.getElementById("lienzo");
    canvas.addEventListener('mousemove', mouseHover);
    canvas.addEventListener('mousemove', zoom);
    let cntx = canvas.getContext("2d");
    
    /**obtenemos el nombre de la imagen cargada desde el input */
    function nombre(fic) {
      fic = fic.split('\\');
      name = fic[fic.length-1];
    }

    /**cargamos la imagen en el canvas */
    function cargarImg() {
      img = new Image();
      img.src = name;
      img.onload = function(){ cntx.drawImage(img, 0, 0); }
      let imgData = cntx.getImageData(0, 0, canvas.width, canvas.height);
    }

    /**encriptamos el mensaje escrito por el usuario */
    function encriptar(){
      let msj = document.getElementById("mensaje").value;
      let imgData = cntx.getImageData(0, 0, canvas.width, canvas.height);
      for(i = 3, cnt = 0; cnt < msj.length; cnt++, i += 4){
        imgData.data[i] = msj.charCodeAt(cnt);
      }
      cntx.putImageData(imgData, 0, 0);
    }

    /**desencriptamos el mensaje oculto en la imagen */
    function desencriptar(){
      let msj;
    }

    /**obtenemos y mostramos el color y la cantidad de rgb por donde pasa el mouse */
    function mouseHover(event){
      let x = event.layerX;
      let y = event.layerY;
      let pix = cntx.getImageData(x, y, canvas.width, canvas.height);
      let rgba = 'rgba('+ pix.data[0] + ',' + pix.data[1] + ',' + pix.data[2] + ',' + pix.data[3] + ')';
      colorDiv.style.background = rgba;
      rgbDiv.textContent = rgba;
    }
    
    function zoom(event){
      let zoomctx = document.getElementById('zoom').getContext('2d');
      let x = event.layerX - 50;
      let y = event.layerY - 50;
      zoomctx.drawImage(canvas, Math.abs(x), Math.abs(y), 100, 100, 0, 0, 300, 300);
    }

    

  </script> 
  
  <div id="colorDiv" style="width: 200px; height: 50px; border: 1px solid red;"></div>
  <div id="rgbDiv" style="width: 200px; height: 50px; border: 1px solid red;"></div>
  <input id="pick" type="file" name="file" accept=".jpg" onchange="nombre(this.value)">
  <input type="button" name="cargar" value="cargar" onclick="cargarImg();">
  <br> <br>
  <textarea id="mensaje" maxlength="100" placeholder="Escriba su msj para encriptar aqui!" rows="10" cols="50"></textarea>
  <br>
  <input type="button" name="submit" value="Submit" onclick="encriptar();">
  


  <!--script type="text/javascript" src="js/scripts.js" ></script-->
</body>
</html>